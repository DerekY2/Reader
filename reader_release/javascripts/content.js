var title,excerpt,content,article_url,author,reading_time,tag_list,lastLogTime,cr_theme_sync,font_family_changed,font_size_changed,line_height_changed,letter_space_changed,max_width_changed,background_color_changed,foreground_color_changed,text_color_changed,link_color_changed,theme_sync_changed,dark_panel_changed,footer_changed,outline_changed,images_changed,meta_changed,author_changed,read_time_changed,previousDarkPanel,previousFooter,previousOutline,previousImages,previousMeta,previousAuthor,previousReadTime,previousThemeSync,previousLinkColor,previousTextColor,previousForegroundColor,previousBackgroundColor,previousFontFamily,previousFontSize,previousLineHeight,previousLetterSpace,previousMaxWidth,tempThemeSync,tempDarkPanel,cr_theme="custom-theme",cr_font_family="Arial",cr_font_size=16,cr_line_height=1,cr_letter_space=0,cr_max_width=680,cr_default_css="\n #cr-body {\n font-family: Arial, Helvetica, sans-serif;\n font-size: 14px;\n }\n\n #cr-body a{\n text-decoration: none;\n }\n\n #cr-meta{\n }\n\n #cr-outline{\n width: 250px;\n position: fixed;\n top: 65px;\n left: 30px;\n }\n\n #cr-content-wrapper a{\n text-decoration: underline;\n }\n\n h1#cr-title,\n #cr-content h1,\n #cr-content h2,\n #cr-content h3,\n #cr-content h4,\n #cr-content h5,\n #cr-content h6 {\n font-weight: 700;\n line-height: 1.3em;\n font-family: inherit;\n margin-top: 1.6em;\n margin-bottom: 0.8em;\n }\n #cr-content #cr-title{\n margin-top: 40px;\n }\n #cr-content p{\n word-break: break-word;\n margin-top: 1.5em;\n margin-bottom: 1.5em;\n }\n #cr-content figure{\n padding: 0;\n margin: 0;\n }\n #cr-content img{\n max-width: 100% !important;\n height: auto !important;\n margin: 30px auto;\n display: block;\n }\n #cr-content table{\n border-spacing: 0px;\n border-collapse: collapse;\n }\n #cr-content table td, #cr-content table th {\n text-align: left;\n font-size: 14px;\n border-width: 1px;\n border-style: solid;\n border-color: rgb(229, 229, 229);\n border-image: initial;\n padding: 17px;\n }\n #cr-content blockquote {\n text-decoration: none;\n opacity: 0.7;\n }\n #cr-content blockquote:before {\n content: 'e244';\n font-family: 'Material Icons';\n float: left;\n font-size: 350%;\n font-style: normal;\n font-weight: normal;\n line-height: 0.6;\n opacity: 0.2;\n }\n\n /* Customize the scrollbar track */\n ::-webkit-scrollbar {\n width: 12px;\n }\n \n /* Customize the scrollbar handle */\n ::-webkit-scrollbar-thumb {\n background-color: transparent;\n border-radius: 6px;\n }\n \n /* Customize the scrollbar track on hover */\n ::-webkit-scrollbar-track:hover {\n background-color: transparent;\n }\n",cr_background_color_light="#FFFFFF",cr_text_color_light="#333333",cr_link_color_light="#5F6368",cr_background_color_dark="#35363a",default_background_color_dark="#35363a",default_background_color_light="#e6e6e6",default_text_color_light="#333333",default_link_color_light="#5F6368",default_text_color_dark="#E0E0E0",default_linkcolor_dark="#FFFFFF",cr_foreground_color_light="#e6e6e6",cr_foreground_color_dark="#464545",cr_background_w_color_dark="#464545",default_foreground_color_light="#FFFFFF",default_foreground_color_dark="#464545",cr_text_color_dark="#E0E0E0",cr_link_color_dark="#FFFFFF",cr_background_color="#F8F1E3",cr_foreground_color="#FFFFFF",cr_text_color="#333333",cr_link_color="#5F6368",cr_dark_panel="on",cr_display_footer="on",cr_display_outline="off",cr_display_images="on",cr_display_meta="on",cr_display_author="on",cr_display_reading_time="on",tempLastTheme="custom-theme";function showPalette(e,t){e?e&&($(t).find("#options-background-color").show(),$(t).find("#options-foreground-color").show(),$(t).find("#options-text-color").show(),$(t).find("#options-link-color").show()):($(t).find("#options-background-color").hide(),$(t).find("#options-foreground-color").hide(),$(t).find("#options-text-color").hide(),$(t).find("#options-link-color").hide())}function media_clipboard(e,t){$(e).find(t).click((function(){let o=$(this).attr("data-clipboard-text");const n=document.createElement("textarea");n.value=o,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),btn_clipboard_copy=$(e).find(t+" .fa-copy"),$("<span class='btn-clipboard-copied'>Copied!</span>").insertBefore(btn_clipboard_copy).fadeOut(1e3,(function(){$(this).remove()}))}))}function init_tags(e,t){$(e).find(t).tagit({placeholderText:"Tags...",availableTags:["read-it-later","research"],onTagLimitExceeded:function(e,t){},afterTagRemoved:function(o,n){tag_list=$(e).find(t).val()}})}function isEmpty(e){return"string"==typeof e&&!e.trim()||null==e}function outlineDisplayToggle(e){var t=$(e).find("#cr-outline"),o=$(window).width();o<=1280?($(t).hide(),$(t).css("width","0")):($(t).show(),t.css("width","250px")),$(window).resize((function(){(o=$(window).width())<=1280?($(t).hide(),$(t).css("width","0")):($(t).show(),$(t).css("width","250px"))}))}function getPreloader(){return'<div id=\'cr-pre-loader\' style=\'\n width: 250px;\n height: 100px;\n text-align: center;\n font-family: "Helvetica Neue";\n font-weight: 200;\n color: #c1c1c1;\n letter-spacing: 0.5;\n position: absolute;\n left: 50%;\n top: 50%;\n transform: translate(-50%, -50%);\n -ms-transform: translate(-50%, -50%); /* for IE 9 */\n -webkit-transform: translate(-50%, -50%); /* for Safari */\n \'>\n <style>\n @keyframes pulse {\n 0% { transform: scale(0.95);box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.3); }\n 70% { transform: scale(1);box-shadow: 0 0 0 10px rgba(0, 0, 0, 0); }\n 100% { transform: scale(0.95);box-shadow: 0 0 0 0 rgba(0, 0, 0, 0); }\n }\n </style>\n <div class="blobs-container text-center" style="margin: 0px auto;margin-bottom: 30px;width: 50px;">\n <div class="blob" style="\n background: #dddddd;\n border-radius: 50%;\n margin: 10px;\n height: 20px;\n width: 20px;\n box-shadow: 0 0 0 0 rgba(0, 0, 0, 1);\n transform: scale(1);\n animation: pulse 2s infinite;"\n >\n </div>\n </div>\n <p>Loading...</p>\n </div>'}function rateLimitLog(e,t){const o=Date.now();o-lastLogTime>=1e3?lastLogTime=o:null==lastLogTime&&(lastLogTime=0)}function startPreloader(e){preloader=getPreloader(),$(e).find("body").prepend(preloader)}function getHTMLOfSelection(){if(document.selection&&document.selection.createRange)return document.selection.createRange().htmlText;if(window.getSelection){var e=window.getSelection();if(e.rangeCount>0){var t=e.getRangeAt(0).cloneContents(),o=document.createElement("div");return o.appendChild(t),o.innerHTML}return""}return""}function getParsedArticle(){var e,t=document.location,o={spec:t.href,host:t.host,prePath:t.protocol+"//"+t.host,scheme:t.protocol.substr(0,t.protocol.indexOf(":")),pathBase:t.protocol+"//"+t.host+t.pathname.substr(0,t.pathname.lastIndexOf("/")+1)};return selected_text=getHTMLOfSelection(),e=""!=selected_text?(new DOMParser).parseFromString(selected_text,"text/html"):document.cloneNode(!0),new Readability(o,e).parse()}function trimContent(e){$(e).find("#cr-content span:contains('Image copyright')").css("display","none"),$(e).find("#cr-content figcaption").css("display","none")}function slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function setOutline(e,t){t.title&&""!=t.title&&$(e).find("#cr-outline-list").append("<li><a href='#cr-title'>"+t.title+"</a></li>"),$(t.content).find("h1, h2, h3, h4, h5, h6").each((function(){var t=$(this).text(),o=slugify(t);$(e).find("#cr-outline-list").append("<li><a href='#"+o+"'>"+t+"</a></li>")}))}function setHeadingsForOutline(e){$(e).find("h1, h2, h3, h4, h5, h6").each((function(){var e=slugify($(this).text());"cr-title"!=$(this).attr("id")&&$(this).attr("id",e)}))}function addStyleTags(e){style_url=chrome.runtime.getURL("styles/content.css"),$(e).find("head").append("<link rel='stylesheet' type='text/css' href='"+style_url+"'>"),style_url=chrome.runtime.getURL("styles/base.css"),$(e).find("head").append("<link rel='stylesheet' type='text/css' href='"+style_url+"'>"),style_url=chrome.runtime.getURL("styles/options-panel.css"),$(e).find("head").append("<link rel='stylesheet' type='text/css' href='"+style_url+"'>"),style_url=chrome.runtime.getURL("styles/fontawesome-all.css"),$(e).find("head").append("<link rel='stylesheet' type='text/css' href='"+style_url+"'>"),style_url=chrome.runtime.getURL("styles/tag-it.css"),$(e).find("head").append("<link rel='stylesheet' type='text/css' href='"+style_url+"'>"),style_url=chrome.runtime.getURL("styles/semantic.css"),$(e).find("head").append("<link rel='stylesheet' type='text/css' href='"+style_url+"'>")}function getCheckboxStatus(e){return $(e).is(":checked")?"on":"off"}var scrolling=!1;function startStopScrolling(e){start_btn=$(e).find("#options-manual-scroll .start"),stop_btn=$(e).find("#options-manual-scroll .stop"),speed=parseInt($(e).find("#options-scroll-speed input").val()),0==scrolling?($(e).find("html, body").animate({scrollTop:$(e).height()},speed),$(start_btn).hide(),$(stop_btn).show(),scrolling=!0):($(e).find("body").stop(),$(start_btn).show(),$(stop_btn).hide(),scrolling=!1)}function optionsManualScroll(e){$(e).find("#options-manual-scroll").click((function(){startStopScrolling(e)}))}var last_element,selection,selectedContent,range,rect,showSaveTimeout,deleted_elements=[];function startDeleteElement(e){var t=$(e).find("#cr-content-container"),o=function(e){var t=e.target;last_element!=t&&(null!=last_element&&$(last_element).removeClass("deletion-mode-hovered"),$(t).addClass("deletion-mode-hovered"),last_element=t)},n=function(t){let o;t.preventDefault(),selected=t.target,$(selected).removeClass("deletion-mode-hovered");let n=selected.parentNode;o={type:"delete",index:Array.from(n.children).indexOf(selected),parent:n,elem:n.removeChild(selected)},deleted_elements.push(o),$(e).find("#options-delete-element-undo").show()},r=function(e){27===e.keyCode&&a()},a=function(){$(t).off("mouseover",o),$(t).off("click",n),$(e).off("keydown",r),$(e).find(".deletion-mode-hovered").removeClass("deletion-mode-hovered"),$(e).find("#options-delete-element").show(),$(e).find("#options-delete-element-stop").hide()};$(t).on("mouseover",o),$(t).on("click",n),$(e).on("keydown",r),$(e).find("#options-delete-element-stop").click((function(){a()}))}function undoDeletedElement(e){let t=deleted_elements.pop();t&&t.parent.insertBefore(t.elem,t.parent.children[t.index]),0===deleted_elements.length&&$(e).find("#options-delete-element-undo").hide()}function toolbarDisplayToggle(e){$(e).find("#cr-content-container").mouseup((function(t){if("Range"!==(selection=e.getSelection()).type||$(t.target).hasClass("tlite")||$(t.target).hasClass("no-close")||"cr-toolbar-note-form-textarea"==$(t.target).attr("id")){var o="cr-toolbar",n=$(t.target).parent();$(t.target).attr("id")!=o&&$(n).attr("id")!=o&&$(n).parent().attr("id")!=o&&($(e).find("#cr-toolbar").hide(),$(e).find("#cr-toolbar-note-form").hide())}else selectedContent=selection.toString(),range=selection.getRangeAt(0).cloneRange(),showToolbar(rect=range.getBoundingClientRect(),e)}))}function showToolbar(e,t){var o=t.getElementById("cr-toolbar"),n=(o.offsetWidth,o.offsetHeight);o.style.left=(window.pageXOffset+e.x+(e.width-$(o).width())/2)/2,o.style.top=`${e.top-n-50+t.body.scrollTop}px`,$(o).show()}function toolbarNoteFormToggle(e){$(e).find("#cr-toolbar-note").click((function(t){$(e).find("#cr-toolbar-note-form").toggle()}))}function toolbarActionsHandler(e){$(e).find("#cr-toolbar-translate").click((function(){""!=selectedContent?translateText(e,selectedContent):alert("Text cannot be empty!")})),$(e).find("#cr-toolbar-search").click((function(){""!=selectedContent?searchText(selectedContent):alert("Text cannot be empty!")})),$(e).find("#cr-toolbar-share-twitter").click((function(){""!=selectedContent?shareTwitter(selectedContent):alert("Text cannot be empty!")}))}function optionsAccordian(e){$(e).find("#options-main-panel .options-panel-header").click((function(){$(this).next().is(":visible")?original_state="visible":original_state="hidden",$(e).find("#options-main-panel .options-panel-header").removeClass("active"),$(e).find("#options-main-panel .options-panel-content").removeClass("active"),$(e).find("#options-main-panel .options-panel-content").hide(),"visible"==original_state?($(this).removeClass("active"),$(this).next().removeClass("active"),$(this).next().slideUp(500)):($(this).addClass("active"),$(this).next().addClass("active"),$(this).next().slideDown(500))}))}function optionsColorPicker(e){$(e).on("change","input[type=color]",(function(){$(this.parentNode).next().val($(this).val()),this.parentNode.style.backgroundColor=this.value}))}function readingTime(e){var t=e.split(/\s/g).length/200;return Math.ceil(t)}function shareTwitter(e){var t=window.location.href;selectedText=e,selectedText=encodeURIComponent(e),popupwindow("https://twitter.com/intent/tweet?text="+('"'+selectedText+'" - '+t+" via @readermode"),"Share",550,295)}function searchText(e){popupwindow("https://google.com/search?q="+encodeURIComponent(e),"Search",900,540)}function translateText(e,t){popupwindow("https://translate.google.com/#auto/"+$(e).find("#options-translate-to select").find(":selected").val()+"/"+t,"Translate",900,540)}function popupwindow(e,t,o,n){let r=screen.width/2-o/2,a=screen.height/2-n/2;return window.open(e,t,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+o+", height="+n+", top="+a+", left="+r)}function saveStorageValue(e,t){chrome.storage.sync.get(e,(function(o){if(chrome.runtime.lastError)return;o[e]!==t&&chrome.storage.sync.set({[e]:t},(function(){chrome.runtime.lastError||chrome.storage.sync.get(e,(function(e){chrome.runtime.lastError}))}))}))}function setFontFamily(e,t,o){null==previousFontFamily?(previousFontFamily=t,showStyleSave(e)):previousFontFamily!=t?(font_family_changed=!0,showStyleSave(e)):previousFontFamily==t&&(font_family_changed=!1,showStyleSave(e)),cr_font_family=t,o&&saveStorageValue("cr_font_family",t),$(e).find("#cr-content-container").css("font-family",t),$(e).find(`#options-font-family select option[value='${t}']`).prop("selected",!0)}function setFontSize(e,t,o){null==previousFontSize?(previousFontSize=t,showStyleSave(e)):previousFontSize!=t?(font_size_changed=!0,showStyleSave(e)):previousFontSize==t&&(font_size_changed=!1,showStyleSave(e)),cr_font_size=t,o&&saveStorageValue("cr_font_size",t),$(e).find("#cr-content-container").css("font-size",t),$(e).find("#options-font-size input").val(t),$(e).find("#options-font-size .val").text(t)}function setLineHeight(e,t,o){null==previousLineHeight?(previousLineHeight=t,showStyleSave(e)):previousLineHeight!=t?(line_height_changed=!0,showStyleSave(e)):previousLineHeight==t&&(line_height_changed=!1,showStyleSave(e)),cr_line_height=t,o&&saveStorageValue("cr_line_height",t),$(e).find("#cr-content-container").css("line-height",t),$(e).find("#options-line-height input").val(t),$(e).find("#options-line-height .val").text(t)}function setLetterSpace(e,t,o){null==previousLetterSpace?(previousLetterSpace=t,showStyleSave(e)):previousLetterSpace!=t?(letter_space_changed=!0,showStyleSave(e)):previousLetterSpace==t&&(letter_space_changed=!1,showStyleSave(e)),cr_letter_space=t,o&&saveStorageValue("cr_letter_space",t),$(e).find("#cr-content-container").css("letter-spacing",t),$(e).find("#options-letter-space input").val(t),$(e).find("#options-letter-space .val").text(t)}function setMaxWidth(e,t,o){null==previousMaxWidth?(previousMaxWidth=t,showStyleSave(e)):previousMaxWidth!=t?(max_width_changed=!0,showStyleSave(e)):previousMaxWidth==t&&(max_width_changed=!1,showStyleSave(e)),cr_max_width=t,o&&saveStorageValue("cr_max_width",t),cr_max_width=t,$(e).find("#cr-container").css("max-width",t),$(e).find("#options-max-width .val").attr("value",t),$(e).find("#options-max-width .val").text(t)}function setBackgroundColor(e,t,o,n){"light-theme"==o?(cr_background_color_light=default_background_color_light,saveStorageValue("cr_background_color_light",default_background_color_light),n&&saveStorageValue("cr_background_color_light",default_background_color_light)):"dark-theme"==o?(cr_background_color_dark=default_background_color_dark,n&&saveStorageValue("cr_background_color_dark",default_background_color_dark)):"custom-theme"==o&&(cr_background_color=t,null==previousBackgroundColor?(previousBackgroundColor=t,showThemeSave(e)):previousBackgroundColor!=t?(background_color_changed=!0,showThemeSave(e)):previousBackgroundColor==t&&(background_color_changed=!1,showThemeSave(e)),rateLimitLog("set background color to ",t),n&&saveStorageValue("cr_background_color",t)),$(e).find("#cr-body").css("background-color",t),$(e).find("#options-theme ul li a[data-theme='"+o+"']").css("background-color",t),$(e).find("#options-background-color input[name='background_color']").val(t),$(e).find("#options-background-color input[type='color']").val(t),$(e).find("#options-background-color label.color").css("background-color",t)}function setForegroundColor(e,t,o,n){"light-theme"==o?(cr_foreground_color_light=default_foreground_color_light,n&&saveStorageValue("cr_foreground_color_light",default_foreground_color_light)):"dark-theme"==o?(cr_foreground_color_dark=default_foreground_color_dark,n&&saveStorageValue("cr_foreground_color_dark",default_foreground_color_dark)):"custom-theme"==o&&(cr_foreground_color=t,null==previousForegroundColor?(previousForegroundColor=t,showThemeSave(e)):previousForegroundColor!=t?(foreground_color_changed=!0,showThemeSave(e)):previousForegroundColor==t&&(foreground_color_changed=!1,showThemeSave(e)),rateLimitLog("set Foreground color to ",t),n&&saveStorageValue("cr_foreground_color",t)),$(e).find("#reader-foreground").css({"background-color":t,"box-shadow":"0 8px 16px rgba(0, 0, 0, 0.1)"}),$(e).find("#options-foreground-color input[name='foreground_color']").val(t),$(e).find("#options-foreground-color input[type='color']").val(t),$(e).find("#options-foreground-color label.color").css("background-color",t)}function setTextColor(e,t,o,n){"light-theme"==o?(cr_text_color_light=t,n&&saveStorageValue("cr_text_color_light",t)):"dark-theme"==o?(cr_text_color_dark=t,n&&saveStorageValue("cr_text_color_dark",t)):"custom-theme"==o&&(null==previousTextColor?(previousTextColor=t,showThemeSave(e)):previousTextColor!=t?(text_color_changed=!0,showThemeSave(e)):previousTextColor==t&&(text_color_changed=!1,showThemeSave(e)),cr_text_color=t,n&&saveStorageValue("cr_text_color",t)),$(e).find("#cr-body").css("color",t),$(e).find("#cr-outline a").css("color",t),$(e).find("#cr-content table td").css("color",t),$(e).find("#cr-content table tr").css("color",t),$(e).find("#cr-content table th").css("color",t),$(e).find("#cr-content table").css("border-color",t),$(e).find("#options-text-color input[name='text_color']").val(t),$(e).find("#options-text-color input[type='color']").val(t),$(e).find("#options-text-color label.color").css("background-color",t)}function setLinkColor(e,t,o,n){"light-theme"==o?(cr_link_color_light=t,n&&saveStorageValue("cr_link_color_light",t)):"dark-theme"==o?(cr_link_color_dark=t,n&&saveStorageValue("cr_link_color_dark",t)):"custom-theme"==o&&(cr_link_color=t,null==previousLinkColor?(previousLinkColor=t,showThemeSave(e)):previousLinkColor!=t?(link_color_changed=!0,showThemeSave(e)):previousLinkColor==t&&(link_color_changed=!1,showThemeSave(e)),n&&saveStorageValue("cr_link_color",t)),$(e).find("#cr-body").find("a:not(#cr-outline a)").css("color",t),$(e).find("#options-link-color input[name='link_color']").val(t),$(e).find("#options-link-color input[type='color']").val(t),$(e).find("#options-link-color label.color").css("background-color",t)}function setTheme(e,t,o){cr_theme=t,$(e).find("#options-theme ul li a").each((function(){$(this).attr("data-theme")==t?$(this).addClass("active"):$(this).removeClass("active")})),$(e).find("#cr-body").attr("class",t),"light-theme"==t?(showPalette(!1,e),setBackgroundColor(e,cr_background_color_light.toUpperCase(),"light-theme"),setForegroundColor(e,cr_foreground_color_light.toUpperCase(),"light-theme"),setTextColor(e,cr_text_color_light.toUpperCase(),"light-theme"),setLinkColor(e,cr_link_color_light.toUpperCase(),"light-theme"),$(e).find("::-webkit-scrollbar-track").css("background",cr_background_color_light.toUpperCase())):"dark-theme"==t?(showPalette(!1,e),setBackgroundColor(e,cr_background_color_dark.toUpperCase(),"dark-theme"),setForegroundColor(e,cr_foreground_color_dark.toUpperCase(),"dark-theme"),setTextColor(e,cr_text_color_dark.toUpperCase(),"dark-theme"),setLinkColor(e,cr_link_color_dark.toUpperCase(),"dark-theme"),$(e).find("::-webkit-scrollbar-track").css("background",cr_background_color_dark.toUpperCase())):"custom-theme"==t&&(showPalette(!0,e),setBackgroundColor(e,cr_background_color.toUpperCase(),"custom-theme"),setForegroundColor(e,cr_foreground_color.toUpperCase(),"custom-theme"),setTextColor(e,cr_text_color.toUpperCase(),"custom-theme"),setLinkColor(e,cr_link_color.toUpperCase(),"custom-theme"),$(e).find("::-webkit-scrollbar-track").css("background",cr_background_color.toUpperCase())),"off"==tempThemeSync&&saveStorageValue("last_manual_theme",cr_theme),saveStorageValue("cr_theme",cr_theme)}function setDisplayOutline(e,t,o){null==previousOutline?(previousOutline=t,showOptionsSave(e,0)):previousOutline!=t?(outline_changed=!0,showOptionsSave(e,0)):previousOutline==t&&(outline_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-outline").show(),$(e).find("#options-display-outline input").prop("checked",!0)):($(e).find("#cr-outline").hide(),$(e).find("#options-display-outline input").prop("checked",!1)),cr_display_outline=t,o&&(saveStorageValue("cr_display_outline",t),previousOutline=t)}function setDisplayImages(e,t,o){null==previousImages?(previousImages=t,showOptionsSave(e,0)):previousImages!=t?(images_changed=!0,showOptionsSave(e,0)):previousImages==t&&(images_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-content-container img").show(),$(e).find("#options-display-images input").prop("checked",!0)):($(e).find("#cr-content-container img").hide(),$(e).find("#options-display-images input").prop("checked",!1)),o&&(cr_display_images=t,saveStorageValue("cr_display_images",t),previousImages=t)}function setDisplayMeta(e,t,o){null==previousMeta?(previousMeta=t,showOptionsSave(e,0)):previousMeta!=t?(meta_changed=!0,showOptionsSave(e,0)):previousMeta==t&&(meta_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-container #cr-meta").show(),$(e).find("#options-display-meta input").prop("checked",!0),$(e).find("#options-display-author").show(),$(e).find("#options-display-reading-time").show()):($(e).find("#cr-container #cr-meta").hide(),$(e).find("#options-display-meta input").prop("checked",!1),$(e).find("#options-display-author").hide(),$(e).find("#options-display-reading-time").hide()),o&&(cr_display_meta=t,saveStorageValue("cr_display_meta",t),previousMeta=t)}function setDisplayAuthor(e,t,o){null==previousAuthor?(previousAuthor=t,showOptionsSave(e,0)):previousAuthor!=t?(author_changed=!0,showOptionsSave(e,0)):previousAuthor==t&&(author_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-container #cr-meta-author").show(),$(e).find("#options-display-author input").prop("checked",!0)):($(e).find("#cr-container #cr-meta-author").hide(),$(e).find("#options-display-author input").prop("checked",!1)),o&&(cr_display_author=t,saveStorageValue("cr_display_author",t),previousAuthor=t)}function setDisplayReadingTime(e,t,o){null==previousReadTime?(previousReadTime=t,showOptionsSave(e,0)):previousReadTime!=t?(read_time_changed=!0,showOptionsSave(e,0)):previousReadTime==t&&(read_time_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-container #cr-meta-reading-time").show(),$(e).find("#options-display-reading-time input").prop("checked",!0)):($(e).find("#cr-container #cr-meta-reading-time").hide(),$(e).find("#options-display-reading-time input").prop("checked",!1)),o&&(cr_display_reading_time=t,saveStorageValue("cr_display_reading_time",t),previousReadTime=t)}function setDarkPanel(e,t,o){tempDarkPanel=t,null==previousDarkPanel?(previousDarkPanel=t,showOptionsSave(e,0)):previousDarkPanel!=t?(dark_panel_changed=!0,showOptionsSave(e,0)):previousDarkPanel==t&&(dark_panel_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-container .options-panel").addClass("options-panel-dark"),$(e).find("#options-dark-panel input").prop("checked",!0),cr_dark_panel=t):($(e).find("#cr-container .options-panel").attr("class","options-panel"),$(e).find("#options-dark-panel input").prop("checked",!1),cr_dark_panel=t),o&&(saveStorageValue("cr_dark_panel",t),previousDarkPanel=t)}function setThemeSync(e,t,o){null==previousThemeSync?(previousThemeSync=t,showThemeSave(e,0)):previousThemeSync!=t?(theme_sync_changed=!0,showOptionsSave(e,0)):previousThemeSync==t&&(theme_sync_changed=!1,showOptionsSave(e,0)),"on"==t?(saveStorageValue("cr_theme_sync",cr_theme_sync=t),tempThemeSync="on",chrome.storage.sync.get("last_manual_theme",(function(e){tempLastTheme=e.last_manual_theme})),cr_theme=window.matchMedia("(prefers-color-scheme: light)").matches?"light-theme":"dark-theme",$(e).find("#options-theme").hide(),$(e).find("#options-theme-sync input").prop("checked",!0)):"off"==t&&("on"==tempThemeSync&&(cr_theme=tempLastTheme||"custom-theme"),saveStorageValue("cr_theme_sync",cr_theme_sync=t),$(e).find("#options-theme").show(),$(e).find("#options-theme-sync input").prop("checked",!1)),tempThemeSync=t,previousThemeSync=t,setTheme(e,cr_theme,!0)}function setDisplayFooter(e,t,o){null==previousFooter?(previousFooter=t,showOptionsSave(e,0)):previousFooter!=t?(footer_changed=!0,showOptionsSave(e,0)):previousFooter==t&&(footer_changed=!1,showOptionsSave(e,0)),"on"==t?($(e).find("#cr-container #cr-footer").show(),$(e).find("#options-display-footer input").prop("checked",!0)):($(e).find("#cr-container #cr-footer").hide(),$(e).find("#options-display-footer input").prop("checked",!1)),o&&(cr_display_meta=t,saveStorageValue("cr_display_meta",t),previousFooter=t)}function setDefaultCss(e,t,o){o&&(cr_default_css=t,saveStorageValue("cr_default_css",t)),$(e).find("#options-default-css textarea").html(t),0==$(e).find("#cr_default_css").length&&$("<style id='cr_default_css'>").text(t).appendTo(e.head),$(e).find("#cr_default_css").html(t)}function optionsDefaultSettings(e){chrome.storage.sync.get(["cr_font_family"],(function(t){setFontFamily(e,t.cr_font_family?t.cr_font_family:"Arial",!0)})),chrome.storage.sync.get(["cr_font_size"],(function(t){setFontSize(e,t.cr_font_size?t.cr_font_size:16,!0)})),chrome.storage.sync.get(["cr_line_height"],(function(t){setLineHeight(e,t.cr_line_height?t.cr_line_height:1.84,!0)})),chrome.storage.sync.get(["cr_letter_space"],(function(t){setLetterSpace(e,t.cr_letter_space?t.cr_letter_space:0,!0)})),chrome.storage.sync.get(["cr_max_width"],(function(t){setMaxWidth(e,t.cr_max_width?t.cr_max_width:680,!0)})),chrome.storage.sync.get(["cr_default_css"],(function(t){t.cr_default_css?setDefaultCss(e,t.cr_default_css,!0):fetch(chrome.runtime.getURL("styles/default.css")).then((e=>e.text())).then((t=>{setDefaultCss(e,t,!0),cr_default_css=t}))})),chrome.storage.sync.get(["cr_background_color_light"],(function(t){setBackgroundColor(e,default_background_color_light,"light-theme",!0)})),chrome.storage.sync.get(["cr_foreground_color_light"],(function(t){setForegroundColor(e,default_foreground_color_light,"light-theme",!0)})),chrome.storage.sync.get(["cr_text_color_light"],(function(t){setTextColor(e,default_text_color_light,"light-theme",!0)})),chrome.storage.sync.get(["cr_link_color_light"],(function(t){setLinkColor(e,default_link_color_light,"light-theme",!0)})),chrome.storage.sync.get(["cr_background_color_dark"],(function(t){setBackgroundColor(e,default_background_color_dark,"dark-theme",!0)})),chrome.storage.sync.get(["cr_foreground_color_dark"],(function(t){setForegroundColor(e,default_foreground_color_dark,"dark-theme",!0)})),chrome.storage.sync.get(["cr_text_color_dark"],(function(t){setTextColor(e,default_text_color_dark,"dark-theme",!0)})),chrome.storage.sync.get(["cr_link_color_dark"],(function(t){setLinkColor(e,default_linkcolor_dark,"dark-theme",!0)})),chrome.storage.sync.get(["cr_background_color"],(function(t){setBackgroundColor(e,t.cr_background_color?t.cr_background_color.toUpperCase():"#F8F1E3","custom-theme",!0)})),chrome.storage.sync.get(["cr_foreground_color"],(function(t){setForegroundColor(e,t.cr_foreground_color?t.cr_foreground_color.toUpperCase():"#FFFFFF","custom-theme",!0)})),chrome.storage.sync.get(["cr_text_color"],(function(t){setTextColor(e,t.cr_text_color?t.cr_text_color:"#333333","custom-theme",!0)})),chrome.storage.sync.get(["cr_link_color"],(function(t){setLinkColor(e,t.cr_link_color?t.cr_link_color:"#5F6368","custom-theme",!0)})),chrome.storage.sync.get(["cr_theme"],(function(t){setTheme(e,t.cr_theme?t.cr_theme:"custom-theme",!1)})),chrome.storage.sync.get(["cr_theme_sync"],(function(t){tempThemeSync=t.cr_theme_sync?t.cr_theme_sync:"on",setThemeSync(e,t.cr_theme_sync?t.cr_theme_sync:"on",!0)})),chrome.storage.sync.get(["last_manual_theme"],(function(e){tempLastTheme=e.last_manual_theme?e.last_manual_theme:"custom-theme"})),chrome.storage.sync.get(["cr_dark_panel"],(function(t){setDarkPanel(e,t.cr_dark_panel?t.cr_dark_panel:"on",!0)})),chrome.storage.sync.get(["cr_display_footer"],(function(t){setDisplayFooter(e,t.cr_display_footer?t.cr_display_footer:"on",!0)})),chrome.storage.sync.get(["cr_display_outline"],(function(t){setDisplayOutline(e,t.cr_display_outline?t.cr_display_outline:"off",!0)})),chrome.storage.sync.get(["cr_display_images"],(function(t){setDisplayImages(e,t.cr_display_images?t.cr_display_images:"on",!0)})),chrome.storage.sync.get(["cr_display_meta"],(function(t){setDisplayMeta(e,t.cr_display_meta?t.cr_display_meta:"on",!0)})),chrome.storage.sync.get(["cr_display_author"],(function(t){setDisplayAuthor(e,t.cr_display_author?t.cr_display_author:"on",!0)})),chrome.storage.sync.get(["cr_display_reading_time"],(function(t){setDisplayReadingTime(e,t.cr_display_reading_time?t.cr_display_reading_time:"on",!0)}))}function optionsMenu(e){var t=e.contentWindow.document;$(t).find("#options-menu li a").click((function(){$(t).find("#options-menu li a").attr("class","tooltip"),this_menu=$(this),$(t).find(".options-panel").each((function(e,t){$(this_menu).attr("data-panel")==$(t).attr("id")?$(t).is(":visible")?$(t).hide():($(this_menu).addClass("active"),$(t).show()):$(t).hide()}))})),$(t).find("#options-delete-element").click((function(){$(this).hide(),$(t).find("#options-delete-element-stop").show(),startDeleteElement(t)})),$(t).find("#options-delete-element-undo").click((function(){undoDeletedElement(t)})),$(t).find("#options-fullscreen").click((function(){fullscreen.toggle($("#container")[0]).then((function(){fullscreen.isFullscreen?($(t).find("#options-fullscreen i.enter").hide(),$(t).find("#options-fullscreen i.exit").show()):($(t).find("#options-fullscreen i.enter").show(),$(t).find("#options-fullscreen i.exit").hide())}))})),$(t).find("#options-print").click((function(){$(t).find("#reader-foreground").css({"box-shadow":"0 0px 0px rgba(0, 0, 0, 0.1)"}),e.contentWindow.print(),$(t).find("#reader-foreground").css({"box-shadow":"0 8px 16px rgba(0, 0, 0, 0.1)"})})),$(t).find("#options-saved-panel a.close").click((function(){$(t).find("#options-menu li a").attr("class","tooltip"),$(t).find("#options-saved-panel").hide()})),$(t).find("#options-close").click((function(){removeIframe()}))}function optionsPanelCloseHandler(e){$(e).click((function(t){target=$(t.target),setTimeout((function(){$(e).find(".options-panel").each((function(){id="#"+$(this).attr("id"),$(e).find(id).is(":visible")&&"#options-saved-panel"!=id&&(target.parents(id).length||target.parents("#options-menu").length||($(e).find(id).hide(),$(e).find("#options-menu li a").removeClass("active")))}))}),100)}))}function optionsStyle(e){$(e).find("#options-font-family select").change((function(){setFontFamily(e,$(this).val())})),$(e).find("#options-font-size input").on("input change",(function(){setFontSize(e,$(this).val())})),$(e).find("#options-line-height input").on("input change",(function(){setLineHeight(e,$(this).val())})),$(e).find("#options-letter-space input").on("input change",(function(){setLetterSpace(e,$(this).val())})),$(e).find("#options-max-width input").on("input change",(function(){setMaxWidth(e,$(this).val())})),$(e).find(".options-panel-content button[name='save-options-themes'], .options-panel-content button[name='save-options-style'], .options-panel-content button[name='save-options-reader-components']").click((function(e){}),showStyleSave(e))}function getActiveTheme(e){return active=$(e).find("#options-theme ul li a.active").attr("data-theme"),active}var saving=!1;let themeSaveTimeout,styleSaveTimeout,optionsSaveTimeout;function showThemeSave(e){font_family_changed||font_size_changed||line_height_changed||letter_space_changed||max_width_changed||dark_panel_changed||footer_changed||outline_changed||images_changed||meta_changed||author_changed||read_time_changed||background_color_changed||foreground_color_changed||link_color_changed||text_color_changed?(updateSaveButtonTheme(e),$(e).find(".options-panel-content button[name='save-options-style']").show(),$(e).find(".options-panel-content button[name='save-options-themes']").show(),$(e).find(".options-panel-content button[name='save-options-reader-components']").show(),removeSaveLabel(e),saving=!1,clearTimeout(themeSaveTimeout),clearTimeout(optionsSaveTimeout),clearTimeout(styleSaveTimeout)):(saving?showSaveTimeout=0:saving||(showSaveTimeout=0),themeSaveTimeout=setTimeout((()=>{$(e).find(".options-panel-content button[name='save-options-style']").hide(),$(e).find(".options-panel-content button[name='save-options-themes']").hide(),$(e).find(".options-panel-content button[name='save-options-reader-components']").hide(),saving=!1}),showSaveTimeout))}function showStyleSave(e){font_family_changed||font_size_changed||line_height_changed||letter_space_changed||max_width_changed||dark_panel_changed||footer_changed||outline_changed||images_changed||meta_changed||author_changed||read_time_changed||background_color_changed||foreground_color_changed||link_color_changed||text_color_changed?(updateSaveButtonTheme(e),$(e).find(".options-panel-content button[name='save-options-style']").show(),$(e).find(".options-panel-content button[name='save-options-themes']").show(),$(e).find(".options-panel-content button[name='save-options-reader-components']").show(),removeSaveLabel(e),saving=!1,clearTimeout(themeSaveTimeout),clearTimeout(optionsSaveTimeout),clearTimeout(styleSaveTimeout)):(saving?showSaveTimeout=0:saving||(showSaveTimeout=0),styleSaveTimeout=setTimeout((()=>{$(e).find(".options-panel-content button[name='save-options-style']").hide(),$(e).find(".options-panel-content button[name='save-options-themes']").hide(),$(e).find(".options-panel-content button[name='save-options-reader-components']").hide(),saving=!1}),showSaveTimeout))}function showOptionsSave(e){font_family_changed||font_size_changed||line_height_changed||letter_space_changed||max_width_changed||dark_panel_changed||footer_changed||outline_changed||images_changed||meta_changed||author_changed||read_time_changed||background_color_changed||foreground_color_changed||link_color_changed||text_color_changed?(updateSaveButtonTheme(e),$(e).find(".options-panel-content button[name='save-options-style']").show(),$(e).find(".options-panel-content button[name='save-options-themes']").show(),$(e).find(".options-panel-content button[name='save-options-reader-components']").show(),removeSaveLabel(e),saving=!1,clearTimeout(themeSaveTimeout),clearTimeout(optionsSaveTimeout),clearTimeout(styleSaveTimeout)):(saving?showSaveTimeout=0:saving||(showSaveTimeout=0),optionsSaveTimeout=setTimeout((()=>{$(e).find(".options-panel-content button[name='save-options-style']").hide(),$(e).find(".options-panel-content button[name='save-options-themes']").hide(),$(e).find(".options-panel-content button[name='save-options-reader-components']").hide(),saving=!1}),showSaveTimeout))}function updateSaveButtonTheme(e){const t=$(e).find(".options-panel-content button[name^='save-options']");"on"==tempDarkPanel?(t.removeClass("save-button-light-theme"),t.find("span").removeClass("save-span-light-theme")):"off"==tempDarkPanel&&(t.addClass("save-button-light-theme"),t.find("span").addClass("save-span-light-theme"))}function optionsTheme(e){$(e).find("#options-theme ul li a").click((function(){cr_theme=$(this).attr("data-theme"),setTheme(e,cr_theme,!0)})),$(e).find("#options-theme-sync input").change((function(){setThemeSync(e,getCheckboxStatus($(this)))})),$(e).find("#options-background-color input").on("input change",(function(){setBackgroundColor(e,$(this).val().toUpperCase(),getActiveTheme(e))})),$(e).find("#options-foreground-color input").on("input change",(function(){setForegroundColor(e,$(this).val().toUpperCase(),getActiveTheme(e))})),$(e).find("#options-text-color input").on("input change",(function(){setTextColor(e,$(this).val(),getActiveTheme(e))})),$(e).find("#options-link-color input").on("input change",(function(){setLinkColor(e,$(this).val(),getActiveTheme(e))})),$(e).find(".options-panel-content button[name='save-options-themes'], .options-panel-content button[name='save-options-style'], .options-panel-content button[name='save-options-reader-components']").click((function(e){}),showThemeSave(e,!1))}function optionsReaderComponents(e){$(e).find("#options-dark-panel input").change((function(){setDarkPanel(e,getCheckboxStatus($(this)))})),$(e).find("#options-display-footer input").change((function(){setDisplayFooter(e,getCheckboxStatus($(this)))})),$(e).find("#options-display-outline input").change((function(){setDisplayOutline(e,getCheckboxStatus($(this)))})),$(e).find("#options-display-images input").change((function(){setDisplayImages(e,getCheckboxStatus($(this)))})),$(e).find("#options-display-meta input").change((function(){setDisplayMeta(e,getCheckboxStatus($(this)))})),$(e).find("#options-display-author input").change((function(){setDisplayAuthor(e,getCheckboxStatus($(this)))})),$(e).find("#options-display-reading-time input").change((function(){setDisplayReadingTime(e,getCheckboxStatus($(this)))})),$(e).find("#sitelinkcopy").click((function(e){e.preventDefault();var t=$(this),o=t.attr("href");o&&navigator.clipboard.writeText(o).then((()=>{t.hide();var e=$('<span class="copy-message">Link copied!</span>');t.after(e),setTimeout((function(){e.remove(),t.show()}),1e3)}))})),$(e).find(".options-panel-content button[name='save-options-themes'], .options-panel-content button[name='save-options-style'], .options-panel-content button[name='save-options-reader-components']").click((function(t){cr_font_family=$(e).find("#options-font-family select").find(":selected").val(),cr_font_size=$(e).find("#options-font-size input").val().trim(),cr_line_height=$(e).find("#options-line-height input").val().trim(),cr_letter_space=$(e).find("#options-letter-space input").val().trim(),cr_max_width=$(e).find("#options-max-width input").val().trim(),cr_theme=getActiveTheme(e),cr_theme_sync=getCheckboxStatus($(e).find("#options-theme-sync input")),cr_background_color_active=$(e).find("#options-background-color input[name='background_color']").val().trim().toUpperCase(),cr_foreground_color_active=$(e).find("#options-foreground-color input[name='foreground_color']").val().trim().toUpperCase(),cr_text_color_active=$(e).find("#options-text-color input[name='text_color']").val().trim().toUpperCase(),cr_link_color_active=$(e).find("#options-link-color input[name='link_color']").val().trim().toUpperCase(),cr_auto_dark_panel=getCheckboxStatus($(e).find("#options-dark-panel input")),cr_display_footer=getCheckboxStatus($(e).find("#options-display-footer input")),cr_display_outline=getCheckboxStatus($(e).find("#options-display-outline input")),cr_display_images=getCheckboxStatus($(e).find("#options-display-images input")),cr_display_meta=getCheckboxStatus($(e).find("#options-display-meta input")),cr_display_author=getCheckboxStatus($(e).find("#options-display-author input")),cr_display_reading_time=getCheckboxStatus($(e).find("#options-display-reading-time input")),cr_display_saved_info=getCheckboxStatus($(e).find("#options-display-saved-info input")),font_family_changed&&(saveStorageValue("cr_font_family",cr_font_family),previousFontFamily=cr_font_family,font_family_changed=!1),font_size_changed&&(saveStorageValue("cr_font_size",cr_font_size),previousFontSize=cr_font_size,font_size_changed=!1),line_height_changed&&(saveStorageValue("cr_line_height",cr_line_height),previousLineHeight=cr_line_height,font_size_changed=!1),letter_space_changed&&(saveStorageValue("cr_letter_space",cr_letter_space),previousLetterSpace=cr_letter_space,letter_space_changed=!1),max_width_changed&&(saveStorageValue("cr_max_width",cr_max_width),previousMaxWidth=cr_max_width,max_width_changed=!1),saving=!0,showStyleSave(e),"light-theme"==cr_theme?(cr_background_color_light=cr_background_color_active,cr_foreground_color_light=cr_foreground_color_active,cr_text_color_light=cr_text_color_active,cr_link_color_light=cr_link_color_active,saveStorageValue("cr_background_color_light",cr_background_color_active),saveStorageValue("cr_foreground_color_light",cr_foreground_color_active),saveStorageValue("cr_text_color_light",cr_text_color_active),saveStorageValue("cr_link_color_light",cr_link_color_active)):"dark-theme"==cr_theme?(cr_background_color_dark=cr_background_color_active,cr_foreground_color_dark=cr_foreground_color_active,cr_text_color_dark=cr_text_color_active,cr_link_color_dark=cr_link_color_active,saveStorageValue("cr_background_color_dark",cr_background_color_active),saveStorageValue("cr_foreground_color_dark",cr_foreground_color_active),saveStorageValue("cr_text_color_dark",cr_text_color_active),saveStorageValue("cr_link_color_dark",cr_link_color_active)):"custom-theme"==cr_theme&&(cr_background_color_custom=cr_background_color_active,cr_foreground_color_custom=cr_foreground_color_active,cr_text_color_custom=cr_text_color_active,cr_link_color_custom=cr_link_color_active,background_color_changed&&(saveStorageValue("cr_background_color",cr_background_color_active),previousBackgroundColor=cr_background_color_active,background_color_changed=!1),foreground_color_changed&&(saveStorageValue("cr_foreground_color",cr_foreground_color_active),previousForegroundColor=cr_foreground_color_active,foreground_color_changed=!1),text_color_changed&&(saveStorageValue("cr_text_color",cr_text_color_active),previousTextColor=cr_text_color_active,text_color_changed=!1),link_color_changed&&(saveStorageValue("cr_link_color",cr_link_color_active),previousLinkColor=cr_link_color_active,link_color_changed=!1)),setTheme(e,cr_theme,!0),saving=!0,showThemeSave(e),dark_panel_changed&&(saveStorageValue("cr_dark_panel",cr_auto_dark_panel),previousDarkPanel=cr_auto_dark_panel,dark_panel_changed=!1),footer_changed&&(saveStorageValue("cr_display_footer",cr_display_footer),previousFooter=cr_display_footer,footer_changed=!1),outline_changed&&(saveStorageValue("cr_display_outline",cr_display_outline),previousOutline=cr_display_outline,outline_changed=!1),images_changed&&(saveStorageValue("cr_display_images",cr_display_images),previousImages=cr_display_images,images_changed=!1),meta_changed&&(saveStorageValue("cr_display_meta",cr_display_meta),previousMeta=cr_display_meta,meta_changed=!1),author_changed&&(saveStorageValue("cr_display_author",cr_display_author),previousAuthor=cr_display_author,author_changed=!1),read_time_changed&&(saveStorageValue("cr_display_reading_time",cr_display_reading_time),previousReadTime=cr_display_reading_time,read_time_changed=!1),saving=!0,showOptionsSave(e)}),showOptionsSave(e))}function showToast(e,t,o,n){if("copylink"){let t=e.createElement("div");var r;t.classList.add("toast"),t.innerHTML=o,$(e).find("#toastBox").append(t),$(e).find(".toast").css({"text-color":"black"}),t.classList.add("copylink"),r=2400,$(e).find(".toast").click((function(e){$(this).remove()})),setTimeout((()=>{t.remove()}),r)}}function showSaveLabel(e,t){var o=$("<span class='text-info save-label' id='ui-save-label'>Saved!</span>"),n=$($(t.target).closest("button")).attr("name");if("save-options-reader-components"==n)var r=1*$(t.target).closest("button").outerHeight(),a=10;else if("save-options-themes"==n)r=1*$(t.target).closest("button").outerHeight(),a=20;else if("save-options-style"==n)r=1*$(t.target).closest("button").outerHeight(),a=30;var i={"font-family":$(t.target).closest("button").css("font-family"),"font-size":$(t.target).closest("button").css("font-size"),"font-weight":$(t.target).closest("button").css("font-weight"),"font-style":$(t.target).css("font-style"),color:$(t.target).closest("button").css("color")};o.css(i),o.css("height",r+"px"),o.css("padding-top",a+"px"),o.insertAfter($(t.target).closest("button")),o.fadeOut(1500,(function(){$(this).remove()}))}function removeSaveLabel(e){var t=$(e).find("#ui-save-label");t.length>0&&t.remove()}function markAsChanged(e){switch(e){case 0:font_family_changed=!0;case 1:font_size_changed=!0;case 2:line_height_changed=!0;case 3:letter_space_changed=!0;case 4:max_width_changed=!0;case 5:background_color_changed=!0;case 6:foreground_color_changed=!0;case 7:text_color_changed=!0;case 8:link_color_changed=!0;case 9:dark_panel_changed=!dark_panel_changed;case 10:footer_changed=!footer_changed;case 11:outline_changed=!outline_changed;case 12:images_changed=!images_changed;case 13:meta_changed=!meta_changed;case 14:author_changed=!author_changed;case 15:read_time_changed=!read_time_changed}}function init(){var e=document.getElementById("cr-iframe"),t=e.contentWindow.document,o=getParsedArticle();if(title=o.title,excerpt=o.excerpt,content=o.content,article_url=window.location.href,""==o.byline||"About 0 Minutes"==o.byline)var n="Unknown author";else n=o.byline;reading_time=readingTime(title+" "+content)+" min read",content=content.replace("Media playback is unsupported on your device",""),fetch(chrome.runtime.getURL("/content.html")).then((e=>e.text())).then((r=>{t.open(),t.write(r),t.close(),startPreloader(t),setOutline(t,o),$(t).find("#cr-title").html(title),$(t).find("#cr-content").html(content),setHeadingsForOutline(t),$(t).find("#cr-content a").attr("target","_blank"),article_url&&$(t).find("#cr-meta").append("<li id='cr-meta-url'><i class='fas fa-link'></i><span class='truncated'><a id='sitelinkcopy' href='"+article_url+"' target='_blank' >"+article_url+"</a></span><li>"),n&&$(t).find("#cr-meta").append("<li id='cr-meta-author'><i class='fas fa-pen-fancy'></i><span class='cr-author truncated'>"+n+"</span><li>"),reading_time&&$(t).find("#cr-meta").append("<li id='cr-meta-reading-time'><i class='far fa-clock'></i><span>"+reading_time+"</span><li>"),trimContent(t),addStyleTags(t),toolbarDisplayToggle(t),toolbarNoteFormToggle(t),toolbarActionsHandler(t),optionsDefaultSettings(t),optionsMenu(e),optionsPanelCloseHandler(t),optionsManualScroll(t),optionsAccordian(t),optionsColorPicker(t),optionsStyle(t),optionsTheme(t),optionsReaderComponents(t),$(t).find("body").css("margin",0),$(e).show(),setTimeout((function(){$(t).find("#cr-pre-loader").fadeOut(),$(t).find("#cr-body").show()}),500)})).catch((e=>{alert("Something went wrong... "+e)}))}var latest_url;function launch(){if(null==document.getElementById("cr-iframe")){var e=createIframe();document.body.appendChild(e),latest_url=window.location.href,init()}else removeIframe(e)}function createIframe(){document.body.style.overflow="hidden";var e=document.createElement("iframe");return e.id="cr-iframe",e.style.height="100%",e.style.width="100%",e.style.position="fixed",e.style.top="0px",e.style.right="0px",e.style.zIndex="9000000000000000000",e.frameBorder="none",e.style.backgroundColor="#fff",preloader=getPreloader(),$(e).contents().find("body").html(preloader),e}function removeIframe(){$("#cr-iframe").remove(),iframe=null,document.body.style.overflow="auto"}launch();